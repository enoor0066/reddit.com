import{h7 as t,a as e,g$ as s,au as a,dO as o,h8 as i,b as r,dP as l,u as n,v as h,aw as c,t as p,_ as d,g,n as u,e as y}from"./shell-c6dfa469.js";import"./community-onboarding-completed-modal-client-js-ab917ec7.js";import"./faceplate-tabpanel-c114bcc9.js";import"./faceplate-tabgroup-3c467eac.js";import"./index-be299d4e.js";import{x as b,y as m,I as f,s as k}from"./icon-5ce37e54.js";import{l as O}from"./list-item-header-b6f6e197.js";import{a as v,b as T}from"./tab-button-d2c8521e.js";import{d as j}from"./constants-b1a52852.js";import"./hui-user-drawer-client-js-b156b2df.js";import"./TinyGesture-89d9957c.js";import"./age-gate-standalone-client-js-cd633927.js";import"./faceplate-tablist-86af1c32.js";import"./helpers-90efd9f3.js";import"./subreddit-posting-eligibility-7aaffc88.js";import"./filterNullish-48b417d6.js";const M={shift:"⇧",ctrl:"^",alt:"⌥",arrowup:"↑",arrowdown:"↓",arrowleft:"←",arrowright:"→",enter:"↵ Enter",meta:"⌘"," ":"Space"},w=[t.NAVIGATION,t.ACTION,t.MEDIA];var C;!function(t){t.TOGGLE="shreddit-hotkeys-modal:toggle",t.OPENED="shreddit-hotkeys-modal:show"}(C||(C={}));let S=class extends(e(k)){constructor(){super(...arguments),this.activeTabIndex=1,this.registry=s,this.disableShortcuts=!1,this.open=!1,this.modalRef=a(),this.hotkeysMap={},this.hotkeysController=new o(this),this.toggleDialog=()=>{this.dialog&&(this.dialog?.open?this.dialog.hide():this.dialog?.showModal())},this.transformNonModifierKey=t=>{const e=t.toLowerCase(),s=e in M?M[e]:t.toUpperCase();return this.getKeyMarkup(s)},this.getKeyMarkup=t=>b`${j(b`<span class="bg-neutral-background-weak-hover px-2xs rounded-[0.125rem]">${t}</span>`)}`,this.useModifierBasedOnOS=()=>navigator.userAgent.includes("Mac")?M.meta:M.ctrl,this.transformModifierKey=t=>{const e=[],s=this.getKeyMarkup(t.key.toUpperCase());return t.ctrl&&e.push(M.ctrl),t.alt&&e.push(M.alt),t.shift&&e.push(M.shift),t.meta&&e.push(this.useModifierBasedOnOS()),e?b`${this.getKeyMarkup(e.join(" + "))} + ${s}`:s},this.transformKey=t=>"string"==typeof t?this.transformNonModifierKey(t):this.transformModifierKey(t),this.renderHotkey=t=>{const e=[];for(let s=0;s<t.length;s++)s>0&&e.push(b`<span>OR</span>`),e.push(this.transformKey(t[s]));return b`<span class="flex gap-2xs">${e}</span>`},this.createKeyMap=()=>{if(this.registry){this.hotkeysMap={};for(const[t,e]of Object.entries(this.registry)){const{type:s}=e,a={...e,icon:this.renderHotkey(e.keys),id:t};this.hotkeysMap[s]?this.hotkeysMap[s].push(a):this.hotkeysMap[s]=[a]}}},this.createHotkeyCategoryTab=e=>{const s=e===t.NAVIGATION?"page-1":e===t.ACTION?"page-2":"page-3";return v({label:i[e](),size:T.Medium,attributes:{slot:s,onclick:()=>{this.activeTabIndex=parseInt(s.replace(/[a-zA-Z-]/g,""))},"data-test-id":e}})},this.createHotKeyListItem=t=>O({label:t.label(),trailingSlot:t.icon,disabled:this.disableShortcuts,attributes:{"data-test-id":t.id},innerClassName_DO_NOT_USE:"!px-0"}),this.dispatchHotkeyToggle=t=>{const e=t.target,{checked:s}=e;this.dispatchEvent(new CustomEvent(C.TOGGLE,{composed:!0,bubbles:!0,detail:{checked:s,target:e}})),this.trackEvent(r({source:"settings",action:"save",noun:"hotkey"},{setting:{old_value:this.convertToOnOff(!e.checked),value:this.convertToOnOff(e.checked)}})),this.disableShortcuts=!s},this.convertToOnOff=t=>t?"on":"off"}get dialog(){return this.shadowRoot?.querySelector('[dialog-id="hotkeys-dialog"]')}connectedCallback(){super.connectedCallback(),this.createKeyMap(),this.hotkeysController.subscribe(l.SHOW_SHORTCUTS,this.toggleDialog)}disconnectedCallback(){super.disconnectedCallback(),this.hotkeysController.unsubscribe(l.SHOW_SHORTCUTS,this.toggleDialog)}willUpdate(t){t.has("registry")&&this.createKeyMap()}render(){const e=!this.disableShortcuts,s=b` <ac-track trigger="view" san="settings|click|hotkey_help"></ac-track> <rpl-modal-card auto-close class="min-w-[288px] max-w-[640px]"> <h2 slot="title"> Keyboard shortcuts </h2> ${n({appearance:"secondary",attributes:{slot:"close-button"},leadingIcon:m({size:f.Small}),size:h.Small})} <div> <div> <p> Boost your efficiency with keyboard shortcuts! Get into the conversation faster without reaching for your mouse. Below is a complete list of available shortcuts, organized by category. </p> <faceplate-tabgroup pages="${Object.keys(t).length}"> ${[this.createHotkeyCategoryTab(t.NAVIGATION),this.createHotkeyCategoryTab(t.ACTION),this.createHotkeyCategoryTab(t.MEDIA)]} </faceplate-tabgroup> <faceplate-tabpanel pages="${Object.keys(t).length}" pageindex="${this.activeTabIndex}" style="opacity:${this.disableShortcuts?".60":"1"}"> ${w.map(((t,e)=>b`<ul slot="page-${e+1}" class="p-0 m-0"> ${this.hotkeysMap[t]?.map((t=>this.createHotKeyListItem(t)))} </ul>`))} </faceplate-tabpanel> </div> <hr> ${O({label:"Enable shortcuts",innerClassName_DO_NOT_USE:"!px-0",attributes:{"data-test-id":"toggles"},trailingSlot:b`<faceplate-switch-input ?checked="${e}" @input="${this.dispatchHotkeyToggle}"> </faceplate-switch-input>`})} </div> <ac-track trigger="view" san="settings|click|hotkey_help"></ac-track> </rpl-modal-card>`;return b`<rpl-dialog-sheet ${c(this.modalRef)} dialog-id="hotkeys-dialog" ?open="${this.open}" .litTemplateChildren="${s}"></rpl-dialog-sheet>`}};S.styles=[p],d([g()],S.prototype,"activeTabIndex",void 0),d([u({type:Object})],S.prototype,"registry",void 0),d([u({type:Boolean,attribute:"disable-shortcuts"})],S.prototype,"disableShortcuts",void 0),d([u({type:Boolean})],S.prototype,"open",void 0),d([u({type:Object})],S.prototype,"modalRef",void 0),S=d([y("shreddit-hotkeys-modal")],S);export{C as S};
