import{_ as t,n as e,e as s,c as i}from"./shell-c6dfa469.js";import{F as a}from"./faceplate-tabgroup-3c467eac.js";import{S as n,F as o}from"./types-ef7c0612.js";import{R as l}from"./helpers-90efd9f3.js";import{i as r}from"./links-168c9977.js";import{s as p,x as c}from"./icon-5ce37e54.js";import"./settings-controller-9ebf315e.js";import"./faceplate-tabpanel-c114bcc9.js";import"./faceplate-tablist-86af1c32.js";import"./age-gate-standalone-client-js-cd633927.js";import"./constants-b1a52852.js";import"./filterNullish-48b417d6.js";const d="additionalContent";var h;!function(t){t.ADDITION="addition",t.REMOVAL="removal"}(h||(h={}));let u=class extends p{get uncheckedInputs(){return this.querySelectorAll("faceplate-checkbox-input:not([checked])")}get allInputs(){return this.querySelectorAll("faceplate-checkbox-input")}get tabpanel(){return this.querySelector("faceplate-tabpanel")}get badges(){return this.querySelectorAll("temporary-tabgroup span[rpl] span")}get additionalContentInput(){return document.querySelector("#additional-content")}connectedCallback(){super.connectedCallback(),this.initEventListeners();const t=this.getRootNode().host?.closest("report-form");t&&(this.helpers=new l(t)),this.badges&&this.badges.forEach((t=>{const e=t.closest("span.gap-xs");e?.classList.remove("gap-xs"),t.classList.add("hidden")})),this.populateValues()}disconnectedCallback(){super.disconnectedCallback()}firstUpdated(){this.updateComplete.then((()=>{(this.isFlexibleReporting||this.isSmartEscalations)&&this.updateFormState()}))}constructor(){super(),this.selectLimit=2,this.isFlexibleReporting=!1,this.isSmartEscalations=!1,this.initEventListeners=()=>{const t=this.allInputs;t?.forEach((t=>{t.addEventListener("input",this.handleClick)}));const e=this.querySelectorAll("temporary-tabgroup button");e?.forEach((t=>{t.addEventListener("click",this.resetPanelScroll)}));const s=this.querySelectorAll(".empty-state-button");s?.forEach((t=>{t.addEventListener("click",this.toggleEmptyState)}))},this.resetPanelScroll=async()=>{await this.updateComplete,this.tabpanel?.scrollTo(0,0)},this.normalizeValueArray=t=>{const e=Array.from(this.allInputs,(t=>t.getAttribute("data-value"))),s=t?.split(",");return s?.filter((t=>e.includes(t)))},this.populateValues=()=>{const t=this.isFlexibleReporting||this.isSmartEscalations?this.additionalContentInput?.getAttribute("value"):this.helpers?.getHiddenInputValue(d);if(!t)return;const e=this.isSmartEscalations?this.normalizeValueArray(t).slice(0,this.selectLimit):t?.split(",");this.isSmartEscalations&&this.additionalContentInput?.setAttribute("value",e.slice(0,this.selectLimit).toString()),this.populateCheckboxSelections(e),this.populateBadgeCounts(e)},this.populateCheckboxSelections=t=>{const e=t.length===this.selectLimit;this.allInputs.forEach((s=>{const i=s.getAttribute("data-value")??"";t?.includes(i)?s.checked=!0:e&&(s.disabled=!0)}))},this.populateBadgeCounts=t=>{const e=t.reduce(((t,e)=>r(e)?{...t,posts:t.posts+1}:e.startsWith("t1_")?{...t,comments:t.comments+1}:t),{posts:0,comments:0}),s=this.badges[0],i=this.badges[1];e.posts>0&&(s.parentElement?.parentElement?.parentElement?.classList.add("gap-xs"),s.classList.remove("hidden"),s.textContent=e.posts.toString()),e.comments>0&&(i.parentElement?.parentElement?.parentElement?.classList.add("gap-xs"),i.classList.remove("hidden"),i.textContent=e.comments.toString())},this.toggleEmptyState=t=>{const e=this.tabpanel,s=t.currentTarget,i=s.getAttribute("slot")?.split("-")[1];e?.setAttribute("pageindex",`${i}`)},this.disableAllUnchecked=()=>{this.uncheckedInputs.forEach((t=>{t.disabled=!0}))},this.enableAllUnchecked=()=>{this.uncheckedInputs.forEach((t=>{t.removeAttribute("disabled")}))},this.modifyList=(t,e)=>{if(!t)return{modificationType:h.ADDITION,newList:[e]};const s=t.split(",");return s.includes(e)?{modificationType:h.REMOVAL,newList:s.filter((t=>t!==e))}:{modificationType:h.ADDITION,newList:[...s,e]}},this.updateBadgeCounts=t=>{const e=this.querySelector("temporary-tabgroup [faceplate-tab-selected]"),s=e?.querySelector("span[rpl] span");if(!s)return;const i=Number(s.textContent),a=s.parentElement?.parentElement?.parentElement;t===h.ADDITION&&(a?.classList.add("gap-xs"),s.classList.remove("hidden"),s.textContent=`${i+1}`),t===h.REMOVAL&&(i-1==0&&(a?.classList.remove("gap-xs"),s.classList.add("hidden")),s.textContent=""+(i-1))},this.handleClick=async t=>{t.preventDefault(),t.stopPropagation();const e=t.currentTarget,s=e?.getAttribute("data-value")??"",i=this.isFlexibleReporting||this.isSmartEscalations,a=i?this.additionalContentInput?.getAttribute("value")??"":this.helpers?.getHiddenInputValue(d)??"";if(!s)return;const{modificationType:n,newList:o}=this.modifyList(a,s);this.updateBadgeCounts(n),i?this.additionalContentInput?.setAttribute("value",o.toString()):this.helpers?.setHiddenInputValue(d,o.toString()),await this.updateComplete,i&&this.updateFormState(),o.length===this.selectLimit?this.disableAllUnchecked():a.split(",").length===this.selectLimit&&this.enableAllUnchecked()},this.updateFormState=()=>{if(this.isSmartEscalations)this.dispatchEvent(i("update-smart-escalations-form-state",{stepName:n.ADDITIONAL_CONTENT,value:this.additionalContentInput?.getAttribute("value")??"",nextStep:n.FREE_TEXT}));else{const t=Array.from(this.uncheckedInputs,(t=>t.getAttribute("data-value")));this.dispatchEvent(i("report-tracking",{reportFlow:{flowOptionSelected:o.ADD_CONTENT,flowContent:this.additionalContentInput?.getAttribute("value")??"",flowOptionAvailable:t.toString()}})),this.dispatchEvent(i("update-report-form",{fieldName:n.ADDITIONAL_CONTENT,value:this.additionalContentInput?.getAttribute("value")??"",nextAction:{type:this.nextActionType,step:this.nextStep},button:{isDisabled:!1}}))}}}render(){return c`<slot></slot>`}};t([e({type:Number,attribute:"select-limit"})],u.prototype,"selectLimit",void 0),t([e({type:Boolean,attribute:"is-flexible-reporting"})],u.prototype,"isFlexibleReporting",void 0),t([e({type:String,attribute:"data-nextaction"})],u.prototype,"nextActionType",void 0),t([e({type:String,attribute:"data-next-step"})],u.prototype,"nextStep",void 0),t([e({type:Boolean,attribute:"is-smart-escalations"})],u.prototype,"isSmartEscalations",void 0),u=t([s("multi-content-wrapper")],u);let m=class extends a{connectedCallback(){super.connectedCallback(),this._events._events.delete("click"),this._events.define("click",(t=>{const e=t.composedPath();for(let t=0;t<e.length;t++){const s=e[t];if(s instanceof HTMLSpanElement){const t=this.getPageIndexFromSpanWrapper(s);if(0!==t){this.pageIndex=t;break}}}}))}};m=t([s("temporary-tabgroup")],m);
