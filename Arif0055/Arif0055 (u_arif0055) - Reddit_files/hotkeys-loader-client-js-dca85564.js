import{_ as e,n as t,e as s,g$ as i,P as a,h0 as o,h1 as r,h2 as n,h3 as c,h4 as l,dP as h,f$ as d,T as p,O as m,c as u,G as b,h5 as y,h6 as g,J as f,o as k}from"./shell-c6dfa469.js";import{S as v}from"./hotkeys-modal-client-js-6284ab68.js";import{s as j}from"./icon-5ce37e54.js";import"./community-onboarding-completed-modal-client-js-ab917ec7.js";import"./hui-user-drawer-client-js-b156b2df.js";import"./TinyGesture-89d9957c.js";import"./age-gate-standalone-client-js-cd633927.js";import"./faceplate-tabpanel-c114bcc9.js";import"./faceplate-tabgroup-3c467eac.js";import"./faceplate-tablist-86af1c32.js";import"./index-be299d4e.js";import"./helpers-90efd9f3.js";import"./constants-b1a52852.js";import"./filterNullish-48b417d6.js";import"./list-item-header-b6f6e197.js";import"./tab-button-d2c8521e.js";import"./subreddit-posting-eligibility-7aaffc88.js";let E=f,M=k,H=class extends j{constructor(){super(...arguments),this.registry=i,this.pubsub=new a(this),this.compareModifiers=(e,t)=>!!e==!!t,this.hasMatchingModifiers=(e,t)=>{if(!t)return!1;const{metaKey:s,altKey:i,shiftKey:a,ctrlKey:o}=e,{meta:r,alt:n,ctrl:c,shift:l}=t,h=!(navigator.userAgent.includes("Mac")||!r||c||!o);return(this.compareModifiers(s,r)||h)&&(this.compareModifiers(o,c)||h)&&this.compareModifiers(a,l)&&this.compareModifiers(i,n)},this.getContextualSubscriber=(e,t,s)=>{const i=e.composedPath();return Array.from(s).find((s=>this.hasMatchingModifiers(e,o.keys[t]?.[s])&&void 0===r[s]&&i?.find((e=>n.has(e)))))},this.getGlobalSubscriber=(e,t,s)=>Array.from(s).find((s=>this.hasMatchingModifiers(e,o.keys[t]?.[s]))),this.publishHotkeyEvent=async e=>{const t=e.key.toLowerCase(),s=o.keys[t],i=this.getContextualSubscriber(e,t,c),a=this.getGlobalSubscriber(e,t,l),r=i??a;if(s&&(this.enabled||"?"===t)&&(r&&s[r].allowFromInput||!e.composedPath().find((e=>e instanceof HTMLTextAreaElement||e instanceof HTMLInputElement||e instanceof HTMLElement&&e.hasAttribute("contenteditable"))))){if(s[h.SHOW_SHORTCUTS]&&await M({name:d,bodyParams:{enabled:encodeURIComponent(!!this.enabled),open:"true"}}),i)return this.pubsub.publish(p.Hotkeys,{id:i}),void this.cancelEvent(e);a&&(this.pubsub.publish(p.Hotkeys,{id:a}),this.cancelEvent(e))}},this.cancelEvent=e=>{e.preventDefault(),e.stopImmediatePropagation()},this.onHotkeysToggle=async e=>{const{detail:{checked:t,target:s}}=e;try{const e=await E({operation:m.UpdateAccountPreferences,variables:{input:{isHotkeysEnabled:t}}});if(this.enabled=t,e.errors.length>0)throw new Error("Could not save setting")}catch{s.checked=!t;const e=u("faceplate-alert",{level:b.error,cause:"uncategorized",message:"We had some issues saving your changes. Please try again."});this.dispatchEvent(e)}}}connectedCallback(){super.connectedCallback(),document.addEventListener("keydown",this.publishHotkeyEvent),document.addEventListener(v.TOGGLE,this.onHotkeysToggle)}disconnectedCallback(){super.disconnectedCallback(),document.removeEventListener("keydown",this.publishHotkeyEvent),document.removeEventListener(v.TOGGLE,this.onHotkeysToggle)}willUpdate(e){e.has("enabled")&&this.enabled&&!Object.keys(o.keys).length?y(this.registry):e.has("registry")&&(g(),y(this.registry))}};e([t({type:Object})],H.prototype,"registry",void 0),e([t({type:Boolean})],H.prototype,"enabled",void 0),H=e([s("shreddit-hotkeys-controller")],H);
