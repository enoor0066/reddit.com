import{K as t,t as e,_ as s,n as o,g as i,e as n,P as r,T as a,J as c,O as u,bq as p,br as l,bs as h,bt as d}from"./shell-c6dfa469.js";import{x as m,A as b,s as y}from"./icon-5ce37e54.js";import{B as C,b as k}from"./subreddit-posting-eligibility-7aaffc88.js";import{_ as g}from"./utils-69251401.js";import"./click-card-fedbccec.js";import"./create-post-entry-point-wrapper-c985496a.js";import{u as f}from"./community-colors-bc5249a2.js";import{g as v,D as j,s as S}from"./utils-6fa28ae5.js";import"./age-gate-standalone-client-js-cd633927.js";import"./faceplate-hovercard-2774446e.js";import"./user-flair-12bd75e0.js";import"./faceplate-tooltip-fee9b43c.js";let T=class extends(t(y)){constructor(){super(...arguments),this.appearance=C.ALERT,this.outline=!1,this.initialCount=0,this.badgeClassname="",this.setCountEvent="",this.count=0,this.setCount=t=>{this.count=Number(t??0)},this.getCount=()=>this.count}connectedCallback(){super.connectedCallback(),this.count=this.initialCount,this.setCountEvent&&this.subscribe(this.setCountEvent,this.setCount)}disconnectedCallback(){super.disconnectedCallback(),this.setCountEvent&&this.unsubscribe(this.setCountEvent,this.setCount)}render(){return this.count?m`${k({appearance:this.appearance,outline:this.outline,content:g(this.count).toString(),attributes:{className:this.badgeClassname}})}`:b}};T.styles=[e],s([o({type:String})],T.prototype,"appearance",void 0),s([o({type:Boolean})],T.prototype,"outline",void 0),s([o({type:Number,attribute:"initial-count"})],T.prototype,"initialCount",void 0),s([o({type:String,attribute:"badge-classname"})],T.prototype,"badgeClassname",void 0),s([o({type:String,attribute:"set-count-event"})],T.prototype,"setCountEvent",void 0),s([i()],T.prototype,"count",void 0),T=s([n("dynamic-badge")],T);let B=class extends y{constructor(){super(...arguments),this.country="",this.cookieDomain="",this.pubsub=new r(this),this.hasThemeCookieBeenSetByUser=!1}async connectedCallback(){super.connectedCallback(),this.pubsub.subscribe(a.ThemeCookieSetByUser,(()=>{this.hasThemeCookieBeenSetByUser=!0})),this.syncCookieToUserPreference()}async syncCookieToUserPreference(){try{const{data:t}=await c({operation:u.IdentityUserPreferences,variables:{includeNightMode:!0}});if(this.hasThemeCookieBeenSetByUser)return;const e=t.identity?.preferences?.isNightModeEnabled;if(null==e)return;const s=v(),o=s===j.Darkmode;if(null!=s&&e===o)return;f({isDarkMode:e}),S(this.country,this.cookieDomain,e),this.reportMismatch(),this.pubsub.publish(a.ThemeCookieSyncedFromUserPreference)}catch{}}reportMismatch(){const t=p(this.country)&&!l(),e={cookies_enabled:navigator.cookieEnabled&&!t?"true":"false"};this.w3Report(e)}w3Report(t){h({type:d.Counter,name:"shreddit_darkmode_preference_mismatches",value:1,labels:t})}render(){return m`<community-colors></community-colors>`}};s([o({type:String})],B.prototype,"country",void 0),s([o({type:String,attribute:"cookie-domain"})],B.prototype,"cookieDomain",void 0),B=s([n("shreddit-darkmode-syncer")],B);
