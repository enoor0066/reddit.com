import"./faceplate-expandable-section-helper-7ef16909.js";import"./custom-event-a97037f1.js";import{a as t,K as e,b as i,bw as a,J as s,O as r,T as o,c as d,G as n,t as l,u as c,v as h,_ as u,n as p,e as m,r as v,g}from"./shell-c6dfa469.js";import{x as f,z as F,I as S,V as y,X as N,s as b,N as C}from"./icon-5ce37e54.js";import{l as $,L as k}from"./list-item-header-b6f6e197.js";import{a4 as x,a5 as w}from"./age-gate-standalone-client-js-cd633927.js";import"./custom-feed-edit-button-574ead40.js";const O="community_nav";let j=class extends(t(e(b))){constructor(){super(...arguments),this.multiredditPath="",this.displayName="",this.iconSrc="",this.isFavorited=!1,this.sanNoun="",this.getTrackingContext=()=>({customFeed:{id:this.multiredditPath}}),this.onFavoriteClick=async()=>{this.trackEvent(i({source:O,action:"click",noun:this.isFavorited?"unfavorite":"favorite"},this.getTrackingContext()));try{const t={input:{label:this.multiredditPath,favoriteState:this.isFavorited?a.None:a.Favorited}},{data:e}=await s({operation:r.UpdateMultiredditFavoriteState,variables:t});if(e.updateMultiredditFavoriteState?.ok){const t={path:this.multiredditPath,isFavorited:!this.isFavorited};return void this.publish(o.MultiredditFavoriteStatusChange,t)}throw new Error("error updating custom feed favorite status")}catch(t){const e=this.isFavorited?`Failed to remove ${this.displayName} from favorites`:`Failed to add ${this.displayName} to favorites`;this.dispatchEvent(d("faceplate-alert",{level:n.error,cause:"uncategorized",message:e}))}}}static get styles(){return[l]}updated(t){}render(){const t=f`<span class="mr-[2px]">${this.iconSrc?f`<img class="rounded-full" loading="lazy" src="${this.iconSrc}" width="32" height="32" aria-hidden="true" alt="custom feed icon">`:F({size:S.Large})}</span>`;return f`<faceplate-tracker source="${O}" action="click" noun="custom_feed" data-faceplate-tracking-context="${JSON.stringify(this.getTrackingContext())}">${$({href:this.multiredditPath,innerClassName_DO_NOT_USE:"s:rounded-2 bg-transparent",label:f`<div class="truncate">${this.displayName}</div>`,leadingAvatar:t,size:k.Small,trailingSlot:f` ${c({appearance:"plain",leadingIcon:(this.isFavorited?y:N)({size:S.Small}),size:h.Small,attributes:{"aria-label":this.isFavorited?"Remove custom feed from favorites":"Add custom feed to favorites",onclick:t=>{t.preventDefault(),t.stopPropagation(),this.onFavoriteClick()}}})}`})}</faceplate-tracker>`}};u([p({type:String})],j.prototype,"multiredditPath",void 0),u([p({type:String})],j.prototype,"displayName",void 0),u([p({type:String})],j.prototype,"iconSrc",void 0),u([p({type:Boolean})],j.prototype,"isFavorited",void 0),u([p({type:String})],j.prototype,"sanNoun",void 0),j=u([m("left-nav-multireddit-item")],j);class P extends(e(b)){constructor(){super(),this.initialStateJSON="[]",this.items=[],this.triggerReload=()=>{this.dispatchEvent(new CustomEvent(x))},this.updateFavoritedState=({path:t,isFavorited:e})=>{const i=[...this.items],a=i.findIndex((e=>e.path===t));-1!==a&&i[a].isFavorited!==e&&(i[a].isFavorited=e,this.items=z(i))},this.reloadController=new w(this,{reloadUrl:"/svc/shreddit/left-nav-multireddits-section",containerSelector:"left-nav-multireddits-controller",mode:v.Replace})}connectedCallback(){super.connectedCallback(),this.items=z(JSON.parse(this.initialStateJSON)),this.subscribe(o.MultiredditFavoriteStatusChange,this.updateFavoritedState),this.subscribe(o.CustomFeedUpdated,this.triggerReload,!1),this.subscribe(o.CustomFeedCreated,this.triggerReload,!1),this.subscribe(o.CustomFeedDeleted,this.triggerReload,!1)}render(){return f`<div> ${this.reloadController?.isLoading?f`<shreddit-loading></shreddit-loading>`:f`${C(this.items,(t=>f`<left-nav-multireddit-item sanNoun="${this.sanNoun}" multiredditPath="${t.path}" displayName="${t.displayName}" iconSrc="${t.icon}" ?isFavorited="${t.isFavorited}"></left-nav-multireddit-item>`))}`} </div>`}}function z(t){return[...t.sort(((t,e)=>t.isFavorited===e.isFavorited?t.displayName.toLowerCase()>e.displayName.toLowerCase()?1:-1:t.isFavorited?-1:1))]}u([p({type:String})],P.prototype,"initialStateJSON",void 0),u([g()],P.prototype,"items",void 0);let _=class extends P{constructor(){super(...arguments),this.sanNoun="multireddits_menu"}};_=u([m("left-nav-multireddits-controller")],_);
